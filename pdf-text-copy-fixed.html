<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFæ–‡æœ¬å¤åˆ¶ - ä¼˜åŒ–ç‰ˆ</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #1a1a2e;
            color: #fff;
            min-height: 100vh;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .toolbar {
            background: #2d2d44;
            padding: 0.75rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            border-bottom: 1px solid #3d3d5c;
        }

        .btn-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        button {
            padding: 0.5rem 1rem;
            background: #3d3d5c;
            color: #fff;
            border: 1px solid #4d4d6c;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        button:hover:not(:disabled) {
            background: #4d4d6c;
            transform: translateY(-1px);
        }

        button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        button.primary {
            background: #667eea;
            border-color: #667eea;
        }

        button.primary:hover {
            background: #5a67d8;
        }

        .page-info {
            padding: 0.5rem 1rem;
            background: #3d3d5c;
            border-radius: 6px;
            font-size: 14px;
        }

        .scale-info {
            color: #a0a0c0;
            font-size: 14px;
            padding: 0.5rem;
        }

        .pdf-viewport {
            flex: 1;
            background: #262637;
            overflow: auto;
            position: relative;
            display: flex;
            justify-content: center;
            padding: 2rem;
        }

        .pdf-page-container {
            position: relative;
            margin: 0 auto;
            background: white;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        /* Canvas å±‚ */
        .pdf-canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* æ–‡æœ¬å±‚ - ä¼˜åŒ–ç‰ˆ */
        .textLayer {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            opacity: 0;
            line-height: 1.0;
            user-select: text;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
        }

        .textLayer > span {
            color: transparent;
            position: absolute;
            white-space: pre;
            cursor: text;
            transform-origin: 0% 0%;
        }

        /* æ–‡æœ¬é«˜äº®é€‰æ‹© */
        .textLayer ::selection {
            background: rgba(0, 124, 255, 0.3);
        }

        .textLayer .highlight {
            margin: -1px;
            padding: 1px;
            background-color: rgb(180, 0, 170);
            border-radius: 4px;
        }

        .textLayer .highlight.begin {
            border-radius: 4px 0 0 4px;
        }

        .textLayer .highlight.end {
            border-radius: 0 4px 4px 0;
        }

        .textLayer .highlight.middle {
            border-radius: 0;
        }

        .textLayer .highlight.selected {
            background-color: rgb(0, 100, 0);
        }

        /* æ³¨é‡Šå±‚ */
        .annotationLayer {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
        }

        .annotationLayer section {
            position: absolute;
            text-align: initial;
        }

        .annotationLayer .linkAnnotation > a,
        .annotationLayer .buttonWidgetAnnotation.pushButton > a {
            position: absolute;
            font-size: 1em;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
        }

        .annotationLayer .linkAnnotation > a:hover,
        .annotationLayer .buttonWidgetAnnotation.pushButton > a:hover {
            opacity: 0.2;
            background: #ff0;
            box-shadow: 0 2px 10px #ff0;
        }

        /* åŠ è½½æç¤º */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 3rem;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: rgba(26, 26, 46, 0.95);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #3d3d5c;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* åŠ è½½é®ç½© */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(2px);
            z-index: 999;
            display: none;
        }

        .loading-overlay.active {
            display: block;
        }

        .drop-zone {
            border: 2px dashed #4d4d6c;
            border-radius: 12px;
            padding: 3rem;
            text-align: center;
            background: #2d2d44;
            transition: all 0.3s;
        }

        .drop-zone.dragover {
            border-color: #667eea;
            background: #3d3d5c;
        }

        .file-input {
            display: none;
        }

        .status-bar {
            background: #1a1a2e;
            padding: 0.5rem 1.5rem;
            font-size: 12px;
            color: #a0a0c0;
            border-top: 1px solid #3d3d5c;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tips {
            background: #2d2d44;
            padding: 0.75rem 1.5rem;
            color: #ffd700;
            text-align: center;
            font-size: 14px;
            border-bottom: 1px solid #3d3d5c;
        }

        /* ç¡®ä¿æ–‡æœ¬å±‚å¯è§æ€§å’Œé€‰æ‹©æ€§ */
        .textLayer.visible {
            opacity: 0.2;
            mix-blend-mode: multiply;
        }

        /* é€‰æ‹©è¾…åŠ©æ ·å¼ */
        .textLayer span:hover {
            background: rgba(255, 255, 0, 0.1);
        }

        /* ä¿®å¤æ–‡æœ¬é€‰æ‹©åç§» */
        .textLayer {
            font-family: sans-serif;
            letter-spacing: normal;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” PDF æ–‡æœ¬é€‰æ‹©ä¸å¤åˆ¶ - ä¼˜åŒ–ç‰ˆ</h1>
        </div>

        <div class="tips">
            ğŸ’¡ æç¤ºï¼šæ–‡æœ¬å±‚å·²ä¼˜åŒ–ï¼Œç°åœ¨å¯ä»¥æ›´ç²¾ç¡®åœ°é€‰æ‹©å’Œå¤åˆ¶æ–‡æœ¬ã€‚ä½¿ç”¨é¼ æ ‡æ‹–åŠ¨é€‰æ‹©ï¼ŒCtrl+C å¤åˆ¶
        </div>

        <div class="toolbar">
            <div class="btn-group">
                <input type="file" id="fileInput" class="file-input" accept=".pdf">
                <button class="primary" onclick="document.getElementById('fileInput').click()">
                    ğŸ“‚ æ‰“å¼€PDF
                </button>
            </div>

            <div class="btn-group">
                <button id="prevPage" disabled>â¬… ä¸Šä¸€é¡µ</button>
                <div class="page-info">
                    <span id="pageNum">0</span> / <span id="pageCount">0</span>
                </div>
                <button id="nextPage" disabled>ä¸‹ä¸€é¡µ â¡</button>
            </div>

            <div class="btn-group">
                <button id="zoomOut">â–</button>
                <span class="scale-info">ç¼©æ”¾: <span id="scalePercent">100%</span></span>
                <button id="zoomIn">â•</button>
                <button id="fitWidth">é€‚åº”å®½åº¦</button>
                <button id="fitPage">é€‚åº”é¡µé¢</button>
            </div>

            <div class="btn-group">
                <button id="toggleTextLayer">æ˜¾ç¤º/éšè—æ–‡æœ¬å±‚</button>
                <button id="rotateBtn">ğŸ”„ æ—‹è½¬</button>
            </div>
        </div>

        <div class="pdf-viewport" id="pdfViewport">
            <div class="drop-zone" id="dropZone">
                <h2>ğŸ“„ æ‹–æ‹½PDFæ–‡ä»¶åˆ°è¿™é‡Œ</h2>
                <p>æˆ–ç‚¹å‡»"æ‰“å¼€PDF"æŒ‰é’®é€‰æ‹©æ–‡ä»¶</p>
            </div>
        </div>

        <div class="status-bar">
            <span id="statusText">å°±ç»ª</span>
            <span id="mousePosition"></span>
        </div>
    </div>

    <!-- å¼•å…¥ PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    
    <script>
        // é…ç½® PDF.js - ä¼˜åŒ–åŠ è½½æ€§èƒ½
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        // ç¦ç”¨ä¸å¿…è¦çš„æ§åˆ¶å°æ—¥å¿—
        if (typeof console !== 'undefined' && console.log) {
            const originalLog = console.log;
            console.log = function(...args) {
                // è¿‡æ»¤æ‰PDF.jsçš„loadingæ¶ˆæ¯
                const message = args[0];
                if (typeof message === 'string' && 
                    (message.includes('Loading') || 
                     message.includes('thumbnail') || 
                     message.includes('PDF.js'))) {
                    return;
                }
                originalLog.apply(console, args);
            };
        }

        // å…¨å±€çŠ¶æ€
        let pdfDocument = null;
        let currentPage = 1;
        let currentScale = 1.0;
        let currentRotation = 0;
        let pageRendering = false;
        let pageNumPending = null;
        let textLayerVisible = false;

        // DOM å…ƒç´ 
        const elements = {
            fileInput: document.getElementById('fileInput'),
            prevPage: document.getElementById('prevPage'),
            nextPage: document.getElementById('nextPage'),
            pageNum: document.getElementById('pageNum'),
            pageCount: document.getElementById('pageCount'),
            scalePercent: document.getElementById('scalePercent'),
            pdfViewport: document.getElementById('pdfViewport'),
            dropZone: document.getElementById('dropZone'),
            statusText: document.getElementById('statusText'),
            zoomIn: document.getElementById('zoomIn'),
            zoomOut: document.getElementById('zoomOut'),
            fitWidth: document.getElementById('fitWidth'),
            fitPage: document.getElementById('fitPage'),
            toggleTextLayer: document.getElementById('toggleTextLayer'),
            rotateBtn: document.getElementById('rotateBtn')
        };

        /**
         * æ›´æ–°çŠ¶æ€æ 
         */
        function updateStatus(text) {
            elements.statusText.textContent = text;
        }

        /**
         * æ¸²æŸ“PDFé¡µé¢ - ä¼˜åŒ–ç‰ˆ
         */
        async function renderPage(pageNumber) {
            if (!pdfDocument) return;
            
            pageRendering = true;
            // åªåœ¨é¦–æ¬¡åŠ è½½æ—¶æ˜¾ç¤ºçŠ¶æ€ï¼Œé¡µé¢åˆ‡æ¢æ—¶é™é»˜å¤„ç†
            if (currentPage === 0) {
                updateStatus(`æ­£åœ¨åŠ è½½PDF...`);
            }

            try {
                // è·å–é¡µé¢
                const page = await pdfDocument.getPage(pageNumber);
                
                // è®¡ç®—è§†å£
                const rotation = (currentRotation + page.rotate) % 360;
                const viewport = page.getViewport({ 
                    scale: currentScale,
                    rotation: rotation
                });

                // ä½¿ç”¨æ¸å˜æ•ˆæœæ›¿æ¢å†…å®¹ï¼Œé¿å…é—ªçƒ
                const oldContent = elements.pdfViewport.querySelector('.pdf-page-container');
                if (oldContent) {
                    oldContent.style.opacity = '0.5';
                }

                // åˆ›å»ºé¡µé¢å®¹å™¨
                const pageContainer = document.createElement('div');
                pageContainer.className = 'pdf-page-container';
                pageContainer.style.width = Math.floor(viewport.width) + 'px';
                pageContainer.style.height = Math.floor(viewport.height) + 'px';

                // åˆ›å»º Canvas
                const canvas = document.createElement('canvas');
                canvas.className = 'pdf-canvas';
                const context = canvas.getContext('2d', { alpha: false });
                
                // è®¾ç½® Canvas å°ºå¯¸
                const outputScale = window.devicePixelRatio || 1;
                canvas.width = Math.floor(viewport.width * outputScale);
                canvas.height = Math.floor(viewport.height * outputScale);
                canvas.style.width = Math.floor(viewport.width) + 'px';
                canvas.style.height = Math.floor(viewport.height) + 'px';

                // ä¼˜åŒ–æ¸²æŸ“è´¨é‡
                context.imageSmoothingEnabled = true;
                context.imageSmoothingQuality = 'high';

                // åº”ç”¨ç¼©æ”¾
                const transform = outputScale !== 1 
                    ? [outputScale, 0, 0, outputScale, 0, 0] 
                    : null;

                // æ¸²æŸ“ PDF é¡µé¢
                const renderContext = {
                    canvasContext: context,
                    transform: transform,
                    viewport: viewport,
                    background: 'white'
                };

                await page.render(renderContext).promise;

                // åˆ›å»ºæ–‡æœ¬å±‚
                const textLayerDiv = document.createElement('div');
                textLayerDiv.className = 'textLayer';
                if (textLayerVisible) {
                    textLayerDiv.classList.add('visible');
                }

                // è·å–æ–‡æœ¬å†…å®¹
                const textContent = await page.getTextContent();

                // åˆ›å»ºæ–‡æœ¬å±‚ç‰‡æ®µ
                const textLayerFragment = document.createDocumentFragment();
                const textDivs = [];

                // PDF.js æ–‡æœ¬å±‚æ¸²æŸ“ä»»åŠ¡
                const textLayerRenderTask = pdfjsLib.renderTextLayer({
                    textContentSource: textContent,
                    container: textLayerDiv,
                    viewport: viewport,
                    textDivs: textDivs,
                    textContentItemsStr: [],
                    enhanceTextSelection: true  // å¯ç”¨å¢å¼ºæ–‡æœ¬é€‰æ‹©
                });

                await textLayerRenderTask.promise;

                // åˆ›å»ºæ³¨é‡Šå±‚ï¼ˆç”¨äºé“¾æ¥ç­‰ï¼‰
                const annotationLayerDiv = document.createElement('div');
                annotationLayerDiv.className = 'annotationLayer';

                // è·å–å¹¶æ¸²æŸ“æ³¨é‡Š
                const annotations = await page.getAnnotations();
                if (annotations.length > 0) {
                    pdfjsLib.AnnotationLayer.render({
                        viewport: viewport.clone({ dontFlip: true }),
                        div: annotationLayerDiv,
                        annotations: annotations,
                        page: page,
                        linkService: {
                            getDestinationHash: (dest) => '#',
                            getAnchorUrl: (hash) => '#',
                            navigateTo: (dest) => console.log('Navigate to:', dest),
                            executeNamedAction: (action) => console.log('Execute action:', action)
                        }
                    });
                }

                // ç»„è£…é¡µé¢
                pageContainer.appendChild(canvas);
                pageContainer.appendChild(textLayerDiv);
                pageContainer.appendChild(annotationLayerDiv);
                
                // æ›¿æ¢å†…å®¹
                elements.pdfViewport.innerHTML = '';
                elements.pdfViewport.appendChild(pageContainer);
                
                // æ·¡å…¥æ•ˆæœ
                pageContainer.style.transition = 'opacity 0.3s ease';
                pageContainer.style.opacity = '0';
                requestAnimationFrame(() => {
                    pageContainer.style.opacity = '1';
                });

                // æ›´æ–°é¡µç 
                elements.pageNum.textContent = pageNumber;
                currentPage = pageNumber;
                updateButtons();
                
                // åªåœ¨é¦–æ¬¡åŠ è½½å®Œæˆæ—¶æ›´æ–°çŠ¶æ€
                if (pageNumber === 1 && !window.pdfFirstLoaded) {
                    window.pdfFirstLoaded = true;
                    updateStatus(`PDFåŠ è½½æˆåŠŸ (å…± ${pdfDocument.numPages} é¡µ)`);
                } else {
                    updateStatus('å°±ç»ª');
                }

            } catch (error) {
                console.error('æ¸²æŸ“é”™è¯¯:', error);
                updateStatus(`æ¸²æŸ“å¤±è´¥: ${error.message}`);
            }

            pageRendering = false;

            // å¤„ç†å¾…æ¸²æŸ“é¡µé¢
            if (pageNumPending !== null) {
                renderPage(pageNumPending);
                pageNumPending = null;
            }
        }

        /**
         * æ’é˜Ÿæ¸²æŸ“
         */
        function queueRenderPage(pageNumber) {
            if (pageRendering) {
                pageNumPending = pageNumber;
            } else {
                renderPage(pageNumber);
            }
        }

        /**
         * æ›´æ–°æŒ‰é’®çŠ¶æ€
         */
        function updateButtons() {
            elements.prevPage.disabled = currentPage <= 1;
            elements.nextPage.disabled = !pdfDocument || currentPage >= pdfDocument.numPages;
            elements.scalePercent.textContent = Math.round(currentScale * 100) + '%';
        }

        /**
         * å¯¼èˆªåŠŸèƒ½
         */
        function previousPage() {
            if (currentPage <= 1) return;
            currentPage--;
            queueRenderPage(currentPage);
        }

        function nextPage() {
            if (!pdfDocument || currentPage >= pdfDocument.numPages) return;
            currentPage++;
            queueRenderPage(currentPage);
        }

        /**
         * ç¼©æ”¾åŠŸèƒ½
         */
        function zoomIn() {
            currentScale = Math.min(currentScale * 1.25, 5.0);
            queueRenderPage(currentPage);
        }

        function zoomOut() {
            currentScale = Math.max(currentScale / 1.25, 0.25);
            queueRenderPage(currentPage);
        }

        async function fitWidth() {
            if (!pdfDocument) return;
            const page = await pdfDocument.getPage(currentPage);
            const viewport = page.getViewport({ scale: 1.0 });
            const containerWidth = elements.pdfViewport.clientWidth - 80;
            currentScale = containerWidth / viewport.width;
            queueRenderPage(currentPage);
        }

        async function fitPage() {
            if (!pdfDocument) return;
            const page = await pdfDocument.getPage(currentPage);
            const viewport = page.getViewport({ scale: 1.0 });
            const containerWidth = elements.pdfViewport.clientWidth - 80;
            const containerHeight = elements.pdfViewport.clientHeight - 80;
            currentScale = Math.min(
                containerWidth / viewport.width,
                containerHeight / viewport.height
            );
            queueRenderPage(currentPage);
        }

        /**
         * æ—‹è½¬åŠŸèƒ½
         */
        function rotatePage() {
            currentRotation = (currentRotation + 90) % 360;
            queueRenderPage(currentPage);
        }

        /**
         * åˆ‡æ¢æ–‡æœ¬å±‚å¯è§æ€§
         */
        function toggleTextLayer() {
            textLayerVisible = !textLayerVisible;
            const textLayer = document.querySelector('.textLayer');
            if (textLayer) {
                textLayer.classList.toggle('visible', textLayerVisible);
            }
        }

        /**
         * åŠ è½½PDFæ–‡ä»¶
         */
        async function loadPDF(file) {
            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            showLoadingOverlay();
            updateStatus('æ­£åœ¨åŠ è½½PDF...');
            
            const fileReader = new FileReader();
            
            fileReader.onload = async function() {
                try {
                    const typedArray = new Uint8Array(this.result);
                    
                    // é…ç½®åŠ è½½é€‰é¡¹ï¼Œç¦ç”¨ä¸å¿…è¦çš„æ—¥å¿—
                    const loadingTask = pdfjsLib.getDocument({
                        data: typedArray,
                        cMapUrl: 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/cmaps/',
                        cMapPacked: true,
                        standardFontDataUrl: 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/standard_fonts/',
                        verbosity: 0  // ç¦ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡º
                    });
                    
                    // ç›‘å¬åŠ è½½è¿›åº¦
                    loadingTask.onProgress = function(progressData) {
                        const percent = Math.round((progressData.loaded / progressData.total) * 100);
                        updateStatus(`æ­£åœ¨åŠ è½½PDF... ${percent}%`);
                    };
                    
                    pdfDocument = await loadingTask.promise;
                    
                    // æ›´æ–°é¡µæ•°
                    elements.pageCount.textContent = pdfDocument.numPages;
                    
                    // é‡ç½®çŠ¶æ€
                    currentPage = 0;  // è®¾ä¸º0ï¼Œæ ‡è®°ä¸ºé¦–æ¬¡åŠ è½½
                    currentScale = 1.0;
                    currentRotation = 0;
                    window.pdfFirstLoaded = false;  // é‡ç½®é¦–æ¬¡åŠ è½½æ ‡å¿—
                    
                    // æ¸²æŸ“ç¬¬ä¸€é¡µ
                    await renderPage(1);
                    
                    // éšè—åŠ è½½åŠ¨ç”»
                    hideLoadingOverlay();
                    
                } catch (error) {
                    console.error('PDFåŠ è½½å¤±è´¥:', error);
                    updateStatus(`åŠ è½½å¤±è´¥: ${error.message}`);
                    hideLoadingOverlay();
                }
            };
            
            fileReader.readAsArrayBuffer(file);
        }

        /**
         * æ˜¾ç¤ºåŠ è½½é®ç½©
         */
        function showLoadingOverlay() {
            let overlay = document.querySelector('.loading-overlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.className = 'loading-overlay';
                overlay.innerHTML = `
                    <div class="loading-container">
                        <div class="spinner"></div>
                        <div style="color: #fff; margin-top: 1rem;">æ­£åœ¨åŠ è½½PDF...</div>
                    </div>
                `;
                document.body.appendChild(overlay);
            }
            overlay.classList.add('active');
        }

        /**
         * éšè—åŠ è½½é®ç½©
         */
        function hideLoadingOverlay() {
            const overlay = document.querySelector('.loading-overlay');
            if (overlay) {
                overlay.classList.remove('active');
            }
        }

        /**
         * äº‹ä»¶ç»‘å®š
         */
        elements.fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file && file.type === 'application/pdf') {
                loadPDF(file);
            }
        });

        elements.prevPage.addEventListener('click', previousPage);
        elements.nextPage.addEventListener('click', nextPage);
        elements.zoomIn.addEventListener('click', zoomIn);
        elements.zoomOut.addEventListener('click', zoomOut);
        elements.fitWidth.addEventListener('click', fitWidth);
        elements.fitPage.addEventListener('click', fitPage);
        elements.toggleTextLayer.addEventListener('click', toggleTextLayer);
        elements.rotateBtn.addEventListener('click', rotatePage);

        // æ‹–æ‹½åŠŸèƒ½
        elements.dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.dropZone.classList.add('dragover');
        });

        elements.dropZone.addEventListener('dragleave', () => {
            elements.dropZone.classList.remove('dragover');
        });

        elements.dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.dropZone.classList.remove('dragover');
            
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'application/pdf') {
                loadPDF(file);
            }
        });

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            if (!pdfDocument) return;
            
            switch(e.key) {
                case 'ArrowLeft':
                    previousPage();
                    break;
                case 'ArrowRight':
                    nextPage();
                    break;
                case '+':
                case '=':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        zoomIn();
                    }
                    break;
                case '-':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        zoomOut();
                    }
                    break;
                case '0':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        currentScale = 1.0;
                        queueRenderPage(currentPage);
                    }
                    break;
            }
        });

        updateStatus('ç­‰å¾…é€‰æ‹©PDFæ–‡ä»¶...');
    </script>
</body>
</html>